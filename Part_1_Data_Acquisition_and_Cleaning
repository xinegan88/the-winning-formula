{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Part 1: Data Aquisition and Cleaning"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. Inspecting the Data Source"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The first data source we chose for this project was from a website called \"The Numbers\" which consolidates helpful statistics for movies. Upon inspecting the website we noticed that there was a 'Report Builder' function on the website that allowed us to determine certain parameters. Since we are interested in analyzing trends from more recent films, we decided to limit our selections to movies released between 2010-2019."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In order to further inspect how the report builder worked so that we could automate the report aquisition, we ran a sample report for the year 2010:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Upon inspecting this report we noticed two important things:\n",
    "\n",
    "(1) Each report generated will contain only 100 movies. Knowing this, we decided it would be best to run one report for each year we wanted to analyze. This would create a data set of a more suitable size for analysis.\n",
    "\n",
    "(2) that there was a second form that changed the view of the results to include more parameters. We checked off the parameters that we wanted in the form, and then examined the new hyperlink that was generated in the browser to determine it's structure. Our examination revealed that the hyperlink contained a few main components:\n",
    "\n",
    "#### (a) https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/   \n",
    "    --> reflects the criteria we outlined in the first form.\n",
    "#### (b) 2010/2010   \n",
    "    --> reflects the year we selected in the first form   \n",
    "#### (c) /None/None/None/None/None/None   \n",
    "    --> reflects the second part of the criteria we selected in the first form   \n",
    "#### (d) ?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On   \n",
    "    --> reflects the criteria from the second form, including:   \n",
    "    --> which criteria to sort the results by (domestic box office gross)   \n",
    "    --> the financial data that we selected   \n",
    "#### (e) &show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On   \n",
    "    --> reflects more criteria from the second form, including:   \n",
    "    --> Theatrical Distributor i.e. information about studios   \n",
    "    --> Genre   \n",
    "    --> Source i.e. where the idea for the film came from   \n",
    "    --> Production Method i.e. animation versus live action   \n",
    "    --> Creative Type i.e. provides more context about the genre    \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Given this information, we built a webscraper that could obtain the data that we wanted for each year selected."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. Building the Master Data Set"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### The Webscraper"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "(1) First, we needed to import a few libraries:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests # send http requests to the selected webpage\n",
    "import pandas as pd # read, save, and manipulate data in a dataframe form"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "(2) Next, we needed to create an iterator using a for loop so that the process of obtaining the information for each year could be automated. This for loop uses a range object to change the value of i based on the year we wish to obtain.   \n",
    "\n",
    "(3) The URL that we needed was especially long, so for readability we divided it into seperate parts for readability.   \n",
    "\n",
    "(4) Then, the URL was defined using the variables containing each part, with the year inserted as a variable in the appropriate spot, to create a unique URL for the year determined in that iteration.   \n",
    "\n",
    "(5) The browser information needed for the headers parameter in requests.get() is stored in the (headers) variable.    \n",
    "\n",
    "(6) requests.get(), with the specified URL as the arguement is stored in a variable (r).\n",
    "\n",
    "(7) pd.read_html is used to read html objects from the web and return them in pandas dataframe form. In this case, the variable (r) is taken as the argument with the method .text.\n",
    "\n",
    "(8) Use pandas to create a unique CSV with the name of the year."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2010 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2010/2010/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n",
      "[    Unnamed: 0  Released                                   Title  \\\n",
      "0            1      2010                             Toy Story 3   \n",
      "1            2      2010                     Alice in Wonderland   \n",
      "2            3      2010                              Iron Man 2   \n",
      "3            4      2010              The Twilight Saga: Eclipse   \n",
      "4            5      2010  Harry Potter and the Deathly Hallows:…   \n",
      "..         ...       ...                                     ...   \n",
      "95          96      2010                             Daybreakers   \n",
      "96          97      2010           Nanny McPhee and the Big Bang   \n",
      "97          98      2010                              The Switch   \n",
      "98          99      2010                       Brooklyn's Finest   \n",
      "99         100      2010                                 Machete   \n",
      "\n",
      "   TheatricalDistributor              Genre  \\\n",
      "0            Walt Disney          Adventure   \n",
      "1            Walt Disney          Adventure   \n",
      "2     Paramount Pictures             Action   \n",
      "3   Summit Entertainment              Drama   \n",
      "4           Warner Bros.          Adventure   \n",
      "..                   ...                ...   \n",
      "95             Lionsgate             Horror   \n",
      "96             Universal          Adventure   \n",
      "97               Miramax    Romantic Comedy   \n",
      "98        Overture Films  Thriller/Suspense   \n",
      "99      20th Century Fox             Action   \n",
      "\n",
      "                               Source       ProductionMethod  \\\n",
      "0                 Original Screenplay      Digital Animation   \n",
      "1   Based on Fiction Book/Short Story  Animation/Live Action   \n",
      "2        Based on Comic/Graphic Novel            Live Action   \n",
      "3   Based on Fiction Book/Short Story            Live Action   \n",
      "4   Based on Fiction Book/Short Story  Animation/Live Action   \n",
      "..                                ...                    ...   \n",
      "95                Original Screenplay            Live Action   \n",
      "96  Based on Fiction Book/Short Story            Live Action   \n",
      "97                Original Screenplay            Live Action   \n",
      "98                             Remake            Live Action   \n",
      "99                Original Screenplay            Live Action   \n",
      "\n",
      "            CreativeType ProductionBudget DomesticBox Office  \\\n",
      "0           Kids Fiction     $200,000,000       $415,004,880   \n",
      "1                Fantasy     $200,000,000       $334,191,110   \n",
      "2             Super Hero     $170,000,000       $312,433,331   \n",
      "3                Fantasy      $68,000,000       $300,531,751   \n",
      "4                Fantasy     $125,000,000       $296,131,568   \n",
      "..                   ...              ...                ...   \n",
      "95       Science Fiction      $20,000,000        $30,101,577   \n",
      "96          Kids Fiction      $35,000,000        $29,197,642   \n",
      "97  Contemporary Fiction      $19,000,000        $27,758,465   \n",
      "98  Contemporary Fiction      $17,000,000        $27,163,593   \n",
      "99  Contemporary Fiction      $12,500,000        $26,593,646   \n",
      "\n",
      "   InternationalBox Office WorldwideBox Office  \n",
      "0             $653,874,642      $1,068,879,522  \n",
      "1             $691,300,000      $1,025,491,110  \n",
      "2             $308,723,058        $621,156,389  \n",
      "3             $405,571,077        $706,102,828  \n",
      "4             $664,297,789        $960,429,357  \n",
      "..                     ...                 ...  \n",
      "95             $21,343,926         $51,445,503  \n",
      "96             $68,602,223         $97,799,865  \n",
      "97             $22,100,000         $49,858,465  \n",
      "98             $12,069,640         $39,233,233  \n",
      "99             $19,777,324         $46,370,970  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2010\n",
      "2011 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2011/2011/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n",
      "[    Unnamed: 0  Released                                     Title  \\\n",
      "0            1      2011    Harry Potter and the Deathly Hallows:…   \n",
      "1            2      2011            Transformers: Dark of the Moon   \n",
      "2            3      2011  The Twilight Saga: Breaking Dawn, Part 1   \n",
      "3            4      2011                      The Hangover Part II   \n",
      "4            5      2011    Pirates of the Caribbean: On Stranger…   \n",
      "..         ...       ...                                       ...   \n",
      "95          96      2011       Extremely Loud and Incredibly Close   \n",
      "96          97      2011                                  The Debt   \n",
      "97          98      2011                                The Sitter   \n",
      "98          99      2011                                    Priest   \n",
      "99         100      2011                              The Mechanic   \n",
      "\n",
      "   TheatricalDistributor              Genre  \\\n",
      "0           Warner Bros.          Adventure   \n",
      "1     Paramount Pictures             Action   \n",
      "2   Summit Entertainment              Drama   \n",
      "3           Warner Bros.             Comedy   \n",
      "4            Walt Disney          Adventure   \n",
      "..                   ...                ...   \n",
      "95          Warner Bros.              Drama   \n",
      "96        Focus Features  Thriller/Suspense   \n",
      "97      20th Century Fox             Comedy   \n",
      "98         Sony Pictures             Horror   \n",
      "99             CBS Films             Action   \n",
      "\n",
      "                               Source       ProductionMethod  \\\n",
      "0   Based on Fiction Book/Short Story  Animation/Live Action   \n",
      "1                         Based on TV  Animation/Live Action   \n",
      "2   Based on Fiction Book/Short Story            Live Action   \n",
      "3                 Original Screenplay            Live Action   \n",
      "4            Based on Theme Park Ride            Live Action   \n",
      "..                                ...                    ...   \n",
      "95  Based on Fiction Book/Short Story            Live Action   \n",
      "96                             Remake            Live Action   \n",
      "97                Original Screenplay            Live Action   \n",
      "98       Based on Comic/Graphic Novel            Live Action   \n",
      "99                             Remake            Live Action   \n",
      "\n",
      "            CreativeType ProductionBudget DomesticBox Office  \\\n",
      "0                Fantasy     $125,000,000       $381,193,157   \n",
      "1        Science Fiction     $195,000,000       $352,390,543   \n",
      "2                Fantasy     $127,500,000       $281,287,133   \n",
      "3   Contemporary Fiction      $80,000,000       $254,464,305   \n",
      "4                Fantasy     $379,000,000       $241,063,875   \n",
      "..                   ...              ...                ...   \n",
      "95    Historical Fiction      $40,000,000        $31,847,881   \n",
      "96    Historical Fiction      $20,000,000        $31,177,548   \n",
      "97  Contemporary Fiction      $25,000,000        $30,542,576   \n",
      "98               Fantasy      $60,000,000        $29,136,626   \n",
      "99  Contemporary Fiction      $42,500,000        $29,121,498   \n",
      "\n",
      "   InternationalBox Office WorldwideBox Office  \n",
      "0             $960,460,560      $1,341,653,717  \n",
      "1             $771,403,536      $1,123,794,079  \n",
      "2             $408,132,918        $689,420,051  \n",
      "3             $332,000,000        $586,464,305  \n",
      "4             $804,600,000      $1,045,663,875  \n",
      "..                     ...                 ...  \n",
      "95             $23,400,000         $55,247,881  \n",
      "96             $15,426,506         $46,604,054  \n",
      "97              $8,206,828         $38,749,404  \n",
      "98             $55,017,400         $84,154,026  \n",
      "99             $47,225,895         $76,347,393  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2011\n",
      "2012 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2012/2012/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[    Unnamed: 0  Released                              Title  \\\n",
      "0            1      2012                       The Avengers   \n",
      "1            2      2012              The Dark Knight Rises   \n",
      "2            3      2012                   The Hunger Games   \n",
      "3            4      2012                            Skyfall   \n",
      "4            5      2012  The Hobbit: An Unexpected Journey   \n",
      "..         ...       ...                                ...   \n",
      "95          96      2012           The Five-Year Engagement   \n",
      "96          97      2012                        Cloud Atlas   \n",
      "97          98      2012                  One for the Money   \n",
      "98          99      2012                         Alex Cross   \n",
      "99         100      2012             Katy Perry: Part of Me   \n",
      "\n",
      "   TheatricalDistributor                Genre  \\\n",
      "0            Walt Disney               Action   \n",
      "1           Warner Bros.               Action   \n",
      "2              Lionsgate    Thriller/Suspense   \n",
      "3          Sony Pictures               Action   \n",
      "4           Warner Bros.            Adventure   \n",
      "..                   ...                  ...   \n",
      "95             Universal      Romantic Comedy   \n",
      "96          Warner Bros.                Drama   \n",
      "97             Lionsgate               Comedy   \n",
      "98             Lionsgate    Thriller/Suspense   \n",
      "99    Paramount Pictures  Concert/Performance   \n",
      "\n",
      "                               Source       ProductionMethod  \\\n",
      "0        Based on Comic/Graphic Novel  Animation/Live Action   \n",
      "1        Based on Comic/Graphic Novel            Live Action   \n",
      "2   Based on Fiction Book/Short Story            Live Action   \n",
      "3   Based on Fiction Book/Short Story            Live Action   \n",
      "4   Based on Fiction Book/Short Story  Animation/Live Action   \n",
      "..                                ...                    ...   \n",
      "95                Original Screenplay            Live Action   \n",
      "96  Based on Fiction Book/Short Story            Live Action   \n",
      "97  Based on Fiction Book/Short Story            Live Action   \n",
      "98  Based on Fiction Book/Short Story            Live Action   \n",
      "99          Based on Real Life Events            Live Action   \n",
      "\n",
      "               CreativeType ProductionBudget DomesticBox Office  \\\n",
      "0                Super Hero     $225,000,000       $623,357,910   \n",
      "1                Super Hero     $230,000,000       $448,139,099   \n",
      "2           Science Fiction      $80,000,000       $408,010,692   \n",
      "3      Contemporary Fiction     $200,000,000       $304,360,277   \n",
      "4                   Fantasy     $200,000,000       $303,003,568   \n",
      "..                      ...              ...                ...   \n",
      "95     Contemporary Fiction      $30,000,000        $28,700,285   \n",
      "96  Multiple Creative Types     $102,000,000        $27,108,272   \n",
      "97     Contemporary Fiction      $42,000,000        $26,414,527   \n",
      "98     Contemporary Fiction      $35,000,000        $25,888,412   \n",
      "99                  Factual      $12,000,000        $25,326,071   \n",
      "\n",
      "   InternationalBox Office WorldwideBox Office  \n",
      "0             $891,742,301      $1,515,100,211  \n",
      "1             $634,089,008      $1,082,228,107  \n",
      "2             $269,912,687        $677,923,379  \n",
      "3             $806,166,704      $1,110,526,981  \n",
      "4             $714,000,000      $1,017,003,568  \n",
      "..                     ...                 ...  \n",
      "95             $32,923,534         $61,623,819  \n",
      "96            $103,564,882        $130,673,154  \n",
      "97              $9,782,694         $36,197,221  \n",
      "98              $9,538,347         $35,426,759  \n",
      "99              $7,374,368         $32,700,439  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2012\n",
      "2013 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2013/2013/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n",
      "[    Unnamed: 0  Released                            Title  \\\n",
      "0            1      2013  The Hunger Games: Catching Fire   \n",
      "1            2      2013                       Iron Man 3   \n",
      "2            3      2013                           Frozen   \n",
      "3            4      2013                  Despicable Me 2   \n",
      "4            5      2013                     Man of Steel   \n",
      "..         ...       ...                              ...   \n",
      "95          96      2013                         The Host   \n",
      "96          97      2013                  The World's End   \n",
      "97          98      2013                      21 and Over   \n",
      "98          99      2013                      Escape Plan   \n",
      "99         100      2013                          Don Jon   \n",
      "\n",
      "   TheatricalDistributor              Genre  \\\n",
      "0              Lionsgate          Adventure   \n",
      "1            Walt Disney             Action   \n",
      "2            Walt Disney            Musical   \n",
      "3              Universal          Adventure   \n",
      "4           Warner Bros.             Action   \n",
      "..                   ...                ...   \n",
      "95             Open Road  Thriller/Suspense   \n",
      "96        Focus Features             Comedy   \n",
      "97            Relativity             Comedy   \n",
      "98             Lionsgate  Thriller/Suspense   \n",
      "99            Relativity    Romantic Comedy   \n",
      "\n",
      "                                 Source       ProductionMethod  \\\n",
      "0     Based on Fiction Book/Short Story            Live Action   \n",
      "1          Based on Comic/Graphic Novel  Animation/Live Action   \n",
      "2   Based on Folk Tale/Legend/Fairytale      Digital Animation   \n",
      "3                   Original Screenplay      Digital Animation   \n",
      "4          Based on Comic/Graphic Novel            Live Action   \n",
      "..                                  ...                    ...   \n",
      "95    Based on Fiction Book/Short Story            Live Action   \n",
      "96                  Original Screenplay            Live Action   \n",
      "97                  Original Screenplay            Live Action   \n",
      "98                  Original Screenplay            Live Action   \n",
      "99                  Original Screenplay            Live Action   \n",
      "\n",
      "            CreativeType ProductionBudget DomesticBox Office  \\\n",
      "0        Science Fiction     $130,000,000       $424,668,047   \n",
      "1             Super Hero     $200,000,000       $408,992,272   \n",
      "2           Kids Fiction     $150,000,000       $400,738,009   \n",
      "3           Kids Fiction      $76,000,000       $368,065,385   \n",
      "4             Super Hero     $225,000,000       $291,045,518   \n",
      "..                   ...              ...                ...   \n",
      "95       Science Fiction      $50,000,000        $26,623,701   \n",
      "96       Science Fiction      $20,000,000        $26,004,851   \n",
      "97  Contemporary Fiction      $13,000,000        $25,682,380   \n",
      "98  Contemporary Fiction      $70,000,000        $25,135,965   \n",
      "99  Contemporary Fiction       $5,500,000        $24,477,704   \n",
      "\n",
      "   InternationalBox Office WorldwideBox Office  \n",
      "0             $440,200,000        $864,868,047  \n",
      "1             $806,400,000      $1,215,392,272  \n",
      "2             $868,008,165      $1,268,746,174  \n",
      "3             $607,151,450        $975,216,835  \n",
      "4             $376,954,000        $667,999,518  \n",
      "..                     ...                 ...  \n",
      "95             $37,853,350         $64,477,051  \n",
      "96             $21,503,654         $47,508,505  \n",
      "97             $16,513,386         $42,195,766  \n",
      "98             $78,600,000        $103,735,965  \n",
      "99             $16,790,875         $41,268,579  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2013\n",
      "2014 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2014/2014/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[    Unnamed: 0  Released                                  Title  \\\n",
      "0            1      2014                        American Sniper   \n",
      "1            2      2014  The Hunger Games: Mockingjay - Part 1   \n",
      "2            3      2014                Guardians of the Galaxy   \n",
      "3            4      2014    Captain America: The Winter Soldier   \n",
      "4            5      2014                         The Lego Movie   \n",
      "..         ...       ...                                    ...   \n",
      "95          96      2014                         The Best of Me   \n",
      "96          97      2014                    That Awkward Moment   \n",
      "97          98      2014            A Walk Among the Tombstones   \n",
      "98          99      2014                                    Her   \n",
      "99         100      2014                                Boyhood   \n",
      "\n",
      "   TheatricalDistributor              Genre  \\\n",
      "0           Warner Bros.              Drama   \n",
      "1              Lionsgate  Thriller/Suspense   \n",
      "2            Walt Disney             Action   \n",
      "3            Walt Disney             Action   \n",
      "4           Warner Bros.          Adventure   \n",
      "..                   ...                ...   \n",
      "95            Relativity              Drama   \n",
      "96          FilmDistrict    Romantic Comedy   \n",
      "97             Universal             Action   \n",
      "98          Warner Bros.              Drama   \n",
      "99             IFC Films              Drama   \n",
      "\n",
      "                               Source       ProductionMethod  \\\n",
      "0       Based on Factual Book/Article            Live Action   \n",
      "1   Based on Fiction Book/Short Story            Live Action   \n",
      "2        Based on Comic/Graphic Novel  Animation/Live Action   \n",
      "3        Based on Comic/Graphic Novel            Live Action   \n",
      "4                        Based on Toy      Digital Animation   \n",
      "..                                ...                    ...   \n",
      "95  Based on Fiction Book/Short Story            Live Action   \n",
      "96                Original Screenplay            Live Action   \n",
      "97  Based on Fiction Book/Short Story            Live Action   \n",
      "98                Original Screenplay            Live Action   \n",
      "99                Original Screenplay            Live Action   \n",
      "\n",
      "            CreativeType ProductionBudget DomesticBox Office  \\\n",
      "0          Dramatization      $58,000,000       $350,126,372   \n",
      "1        Science Fiction     $125,000,000       $337,135,885   \n",
      "2             Super Hero     $170,000,000       $333,172,112   \n",
      "3             Super Hero     $170,000,000       $259,746,958   \n",
      "4           Kids Fiction      $60,000,000       $257,784,718   \n",
      "..                   ...              ...                ...   \n",
      "95  Contemporary Fiction      $26,000,000        $26,766,213   \n",
      "96  Contemporary Fiction       $8,000,000        $26,068,955   \n",
      "97    Historical Fiction      $28,000,000        $26,017,685   \n",
      "98       Science Fiction      $23,000,000        $25,568,251   \n",
      "99  Contemporary Fiction       $4,000,000        $25,379,975   \n",
      "\n",
      "   InternationalBox Office WorldwideBox Office  \n",
      "0             $197,200,000        $547,326,372  \n",
      "1             $429,439,246        $766,575,131  \n",
      "2             $437,964,895        $771,137,007  \n",
      "3             $454,654,931        $714,401,889  \n",
      "4             $210,300,000        $468,084,718  \n",
      "..                     ...                 ...  \n",
      "95             $14,293,205         $41,059,418  \n",
      "96             $27,000,000         $53,068,955  \n",
      "97             $36,090,902         $62,108,587  \n",
      "98             $22,475,747         $48,043,998  \n",
      "99             $31,893,074         $57,273,049  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2014\n",
      "2015 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2015/2015/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n",
      "[    Unnamed: 0  Released                                 Title  \\\n",
      "0            1      2015  Star Wars Ep. VII: The Force Awakens   \n",
      "1            2      2015                        Jurassic World   \n",
      "2            3      2015               Avengers: Age of Ultron   \n",
      "3            4      2015                            Inside Out   \n",
      "4            5      2015                             Furious 7   \n",
      "..         ...       ...                                   ...   \n",
      "95          96      2015               In the Heart of the Sea   \n",
      "96          97      2015                           The Gallows   \n",
      "97          98      2015                      Hitman: Agent 47   \n",
      "98          99      2015                       Project Almanac   \n",
      "99         100      2015                        Black or White   \n",
      "\n",
      "   TheatricalDistributor      Genre                             Source  \\\n",
      "0            Walt Disney  Adventure                Original Screenplay   \n",
      "1              Universal     Action  Based on Fiction Book/Short Story   \n",
      "2            Walt Disney     Action       Based on Comic/Graphic Novel   \n",
      "3            Walt Disney  Adventure                Original Screenplay   \n",
      "4              Universal     Action                Original Screenplay   \n",
      "..                   ...        ...                                ...   \n",
      "95          Warner Bros.  Adventure          Based on Real Life Events   \n",
      "96          Warner Bros.     Horror                Original Screenplay   \n",
      "97      20th Century Fox     Action                      Based on Game   \n",
      "98    Paramount Pictures  Adventure                Original Screenplay   \n",
      "99            Relativity      Drama          Based on Real Life Events   \n",
      "\n",
      "         ProductionMethod          CreativeType ProductionBudget  \\\n",
      "0   Animation/Live Action       Science Fiction     $306,000,000   \n",
      "1             Live Action       Science Fiction     $215,000,000   \n",
      "2   Animation/Live Action            Super Hero     $365,000,000   \n",
      "3       Digital Animation          Kids Fiction     $175,000,000   \n",
      "4             Live Action  Contemporary Fiction     $190,000,000   \n",
      "..                    ...                   ...              ...   \n",
      "95            Live Action         Dramatization     $100,000,000   \n",
      "96            Live Action               Fantasy         $100,000   \n",
      "97            Live Action  Contemporary Fiction      $35,000,000   \n",
      "98            Live Action       Science Fiction      $12,000,000   \n",
      "99            Live Action  Contemporary Fiction       $9,000,000   \n",
      "\n",
      "   DomesticBox Office InternationalBox Office WorldwideBox Office  \n",
      "0        $936,662,225          $1,128,815,859      $2,065,478,084  \n",
      "1        $652,270,625          $1,018,130,012      $1,670,400,637  \n",
      "2        $459,005,868            $937,093,334      $1,396,099,202  \n",
      "3        $356,461,711            $498,748,492        $855,210,203  \n",
      "4        $353,007,020          $1,165,715,774      $1,518,722,794  \n",
      "..                ...                     ...                 ...  \n",
      "95        $25,020,758             $64,672,551         $89,693,309  \n",
      "96        $22,764,410             $18,892,064         $41,656,474  \n",
      "97        $22,467,450             $59,715,353         $82,182,803  \n",
      "98        $22,348,241             $10,561,196         $32,909,437  \n",
      "99        $21,571,189                $399,832         $21,971,021  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2015\n",
      "2016 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2016/2016/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[    Unnamed: 0  Released                         Title TheatricalDistributor  \\\n",
      "0            1      2016  Rogue One: A Star Wars Story           Walt Disney   \n",
      "1            2      2016                  Finding Dory           Walt Disney   \n",
      "2            3      2016    Captain America: Civil War           Walt Disney   \n",
      "3            4      2016       The Secret Life of Pets             Universal   \n",
      "4            5      2016               The Jungle Book           Walt Disney   \n",
      "..         ...       ...                           ...                   ...   \n",
      "95          96      2016                    The Forest      Focus / Gramercy   \n",
      "96          97      2016                       Ben-Hur    Paramount Pictures   \n",
      "97          98      2016                     The Witch                   A24   \n",
      "98          99      2016        Bridget Jonesâs Baby             Universal   \n",
      "99         100      2016         Kevin Hart: What Now?             Universal   \n",
      "\n",
      "                  Genre                             Source  \\\n",
      "0             Adventure                           Spin-Off   \n",
      "1             Adventure                Original Screenplay   \n",
      "2                Action       Based on Comic/Graphic Novel   \n",
      "3             Adventure                Original Screenplay   \n",
      "4             Adventure  Based on Fiction Book/Short Story   \n",
      "..                  ...                                ...   \n",
      "95    Thriller/Suspense                Original Screenplay   \n",
      "96                Drama  Based on Fiction Book/Short Story   \n",
      "97               Horror                Original Screenplay   \n",
      "98      Romantic Comedy  Based on Fiction Book/Short Story   \n",
      "99  Concert/Performance          Based on Real Life Events   \n",
      "\n",
      "         ProductionMethod          CreativeType ProductionBudget  \\\n",
      "0   Animation/Live Action       Science Fiction     $200,000,000   \n",
      "1       Digital Animation          Kids Fiction     $200,000,000   \n",
      "2             Live Action            Super Hero     $250,000,000   \n",
      "3       Digital Animation          Kids Fiction      $75,000,000   \n",
      "4   Animation/Live Action               Fantasy     $175,000,000   \n",
      "..                    ...                   ...              ...   \n",
      "95            Live Action  Contemporary Fiction      $10,000,000   \n",
      "96            Live Action    Historical Fiction      $95,000,000   \n",
      "97            Live Action    Historical Fiction       $3,500,000   \n",
      "98            Live Action  Contemporary Fiction      $35,000,000   \n",
      "99            Live Action               Factual      $10,000,000   \n",
      "\n",
      "   DomesticBox Office InternationalBox Office WorldwideBox Office  \n",
      "0        $532,177,324            $523,879,949      $1,056,057,273  \n",
      "1        $486,295,561            $539,068,066      $1,025,363,627  \n",
      "2        $408,084,349            $745,200,000      $1,153,284,349  \n",
      "3        $368,384,330            $518,222,082        $886,606,412  \n",
      "4        $364,001,123            $596,358,986        $960,360,109  \n",
      "..                ...                     ...                 ...  \n",
      "95        $26,594,261             $14,154,969         $40,749,230  \n",
      "96        $26,410,477             $65,259,171         $91,669,648  \n",
      "97        $25,138,705             $15,315,815         $40,454,520  \n",
      "98        $24,139,805            $181,682,883        $205,822,688  \n",
      "99        $23,591,043                      $0         $23,591,043  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2016\n",
      "2017 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2017/2017/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n",
      "[    Unnamed: 0  Released                              Title  \\\n",
      "0            1      2017  Star Wars Ep. VIII: The Last Jedi   \n",
      "1            2      2017               Beauty and the Beast   \n",
      "2            3      2017                       Wonder Woman   \n",
      "3            4      2017     Jumanji: Welcome to the Jungle   \n",
      "4            5      2017      Guardians of the Galaxy Vol 2   \n",
      "..         ...       ...                                ...   \n",
      "95          96      2017                 Victoria and Abdul   \n",
      "96          97      2017                        Rough Night   \n",
      "97          98      2017          My Little Pony: The Movie   \n",
      "98          99      2017                          Ballerina   \n",
      "99         100      2017                     Phantom Thread   \n",
      "\n",
      "   TheatricalDistributor         Genre                         Source  \\\n",
      "0            Walt Disney     Adventure            Original Screenplay   \n",
      "1            Walt Disney       Musical                         Remake   \n",
      "2           Warner Bros.        Action   Based on Comic/Graphic Novel   \n",
      "3          Sony Pictures     Adventure            Original Screenplay   \n",
      "4            Walt Disney        Action   Based on Comic/Graphic Novel   \n",
      "..                   ...           ...                            ...   \n",
      "95        Focus Features         Drama  Based on Factual Book/Article   \n",
      "96         Sony Pictures  Black Comedy            Original Screenplay   \n",
      "97             Lionsgate     Adventure                   Based on Toy   \n",
      "98         Weinstein Co.     Adventure            Original Screenplay   \n",
      "99        Focus Features         Drama            Original Screenplay   \n",
      "\n",
      "         ProductionMethod          CreativeType ProductionBudget  \\\n",
      "0   Animation/Live Action       Science Fiction     $200,000,000   \n",
      "1   Animation/Live Action               Fantasy     $160,000,000   \n",
      "2             Live Action            Super Hero     $150,000,000   \n",
      "3             Live Action       Science Fiction      $90,000,000   \n",
      "4   Animation/Live Action            Super Hero     $200,000,000   \n",
      "..                    ...                   ...              ...   \n",
      "95            Live Action         Dramatization      $21,000,000   \n",
      "96            Live Action  Contemporary Fiction      $20,000,000   \n",
      "97      Digital Animation          Kids Fiction       $6,500,000   \n",
      "98      Digital Animation          Kids Fiction      $30,000,000   \n",
      "99            Live Action    Historical Fiction      $35,000,000   \n",
      "\n",
      "   DomesticBox Office InternationalBox Office WorldwideBox Office  \n",
      "0        $620,181,382            $712,358,507      $1,332,539,889  \n",
      "1        $504,014,165            $754,940,539      $1,258,954,704  \n",
      "2        $412,563,408            $408,569,970        $821,133,378  \n",
      "3        $404,508,916            $559,987,277        $964,496,193  \n",
      "4        $389,813,101            $479,300,000        $869,113,101  \n",
      "..                ...                     ...                 ...  \n",
      "95        $22,245,070             $46,026,076         $68,271,146  \n",
      "96        $22,105,643             $24,738,714         $46,844,357  \n",
      "97        $21,885,107             $39,409,537         $61,294,644  \n",
      "98        $21,858,070             $75,032,724         $96,890,794  \n",
      "99        $21,198,205             $26,698,516         $47,896,721  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2017\n",
      "2018 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2018/2018/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[    Unnamed: 0  Released                           Title  \\\n",
      "0            1      2018                   Black Panther   \n",
      "1            2      2018          Avengers: Infinity War   \n",
      "2            3      2018                   Incredibles 2   \n",
      "3            4      2018  Jurassic World: Fallen Kingdom   \n",
      "4            5      2018                         Aquaman   \n",
      "..         ...       ...                             ...   \n",
      "95          96      2018             On the Basis of Sex   \n",
      "96          97      2018    The Strangers: Prey at Night   \n",
      "97          98      2018                  White Boy Rick   \n",
      "98          99      2018     Wonât You Be My Neighbor?   \n",
      "99         100      2018                        Overlord   \n",
      "\n",
      "   TheatricalDistributor        Genre                             Source  \\\n",
      "0            Walt Disney       Action       Based on Comic/Graphic Novel   \n",
      "1            Walt Disney       Action       Based on Comic/Graphic Novel   \n",
      "2            Walt Disney    Adventure                Original Screenplay   \n",
      "3              Universal       Action  Based on Fiction Book/Short Story   \n",
      "4           Warner Bros.       Action       Based on Comic/Graphic Novel   \n",
      "..                   ...          ...                                ...   \n",
      "95        Focus Features        Drama          Based on Real Life Events   \n",
      "96       Aviron Pictures       Horror          Based on Real Life Events   \n",
      "97         Sony Pictures        Drama          Based on Real Life Events   \n",
      "98        Focus Features  Documentary          Based on Real Life Events   \n",
      "99    Paramount Pictures       Action                Original Screenplay   \n",
      "\n",
      "         ProductionMethod        CreativeType ProductionBudget  \\\n",
      "0             Live Action          Super Hero     $200,000,000   \n",
      "1   Animation/Live Action          Super Hero     $300,000,000   \n",
      "2       Digital Animation        Kids Fiction     $200,000,000   \n",
      "3             Live Action     Science Fiction     $170,000,000   \n",
      "4   Animation/Live Action          Super Hero     $160,000,000   \n",
      "..                    ...                 ...              ...   \n",
      "95            Live Action       Dramatization      $20,000,000   \n",
      "96            Live Action       Dramatization       $5,000,000   \n",
      "97            Live Action       Dramatization      $30,000,000   \n",
      "98            Live Action             Factual               $0   \n",
      "99            Live Action  Historical Fiction      $38,000,000   \n",
      "\n",
      "   DomesticBox Office InternationalBox Office WorldwideBox Office  \n",
      "0        $700,059,566            $646,043,810      $1,346,103,376  \n",
      "1        $678,815,482          $1,369,544,272      $2,048,359,754  \n",
      "2        $608,581,744            $634,223,615      $1,242,805,359  \n",
      "3        $417,719,760            $890,751,228      $1,308,470,988  \n",
      "4        $335,061,807            $808,904,713      $1,143,966,520  \n",
      "..                ...                     ...                 ...  \n",
      "95        $24,622,687             $14,178,607         $38,801,294  \n",
      "96        $24,431,472              $7,712,790         $32,144,262  \n",
      "97        $24,004,833              $1,943,150         $25,947,983  \n",
      "98        $22,835,787                 $11,851         $22,847,638  \n",
      "99        $21,704,844             $17,473,345         $39,178,189  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2018\n",
      "2019 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2019/2019/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n",
      "[    Unnamed: 0  Released                             Title  \\\n",
      "0            1      2019                 Avengers: Endgame   \n",
      "1            2      2019                     The Lion King   \n",
      "2            3      2019  Star Wars: The Rise of Skywalker   \n",
      "3            4      2019                         Frozen II   \n",
      "4            5      2019                       Toy Story 4   \n",
      "..         ...       ...                               ...   \n",
      "95          96      2019           47 Meters Down: Uncaged   \n",
      "96          97      2019                    Black and Blue   \n",
      "97          98      2019                           Hellboy   \n",
      "98          99      2019                             Shaft   \n",
      "99         100      2019          The Peanut Butter Falcon   \n",
      "\n",
      "                    TheatricalDistributor              Genre  \\\n",
      "0                             Walt Disney             Action   \n",
      "1                             Walt Disney          Adventure   \n",
      "2                             Walt Disney          Adventure   \n",
      "3                             Walt Disney          Adventure   \n",
      "4                             Walt Disney          Adventure   \n",
      "..                                    ...                ...   \n",
      "95  Entertainment Studios Motion Pictures  Thriller/Suspense   \n",
      "96                          Sony Pictures             Action   \n",
      "97                              Lionsgate             Horror   \n",
      "98                           Warner Bros.             Comedy   \n",
      "99                   Roadside Attractions          Adventure   \n",
      "\n",
      "                          Source       ProductionMethod          CreativeType  \\\n",
      "0   Based on Comic/Graphic Novel  Animation/Live Action            Super Hero   \n",
      "1                         Remake  Animation/Live Action          Kids Fiction   \n",
      "2            Original Screenplay  Animation/Live Action       Science Fiction   \n",
      "3            Original Screenplay      Digital Animation          Kids Fiction   \n",
      "4            Original Screenplay      Digital Animation          Kids Fiction   \n",
      "..                           ...                    ...                   ...   \n",
      "95                Based on Movie            Live Action  Contemporary Fiction   \n",
      "96           Original Screenplay            Live Action  Contemporary Fiction   \n",
      "97                        Remake            Live Action            Super Hero   \n",
      "98           Original Screenplay            Live Action  Contemporary Fiction   \n",
      "99           Original Screenplay            Live Action  Contemporary Fiction   \n",
      "\n",
      "   ProductionBudget DomesticBox Office InternationalBox Office  \\\n",
      "0      $400,000,000       $858,373,000          $1,939,427,564   \n",
      "1      $260,000,000       $543,638,043          $1,113,305,351   \n",
      "2      $275,000,000       $515,202,542            $558,267,058   \n",
      "3      $150,000,000       $477,373,578            $970,176,133   \n",
      "4      $200,000,000       $434,038,008            $639,356,805   \n",
      "..              ...                ...                     ...   \n",
      "95      $12,000,000        $22,260,900             $15,304,333   \n",
      "96      $12,000,000        $22,012,729                $667,249   \n",
      "97      $50,000,000        $21,903,748             $18,882,732   \n",
      "98      $30,000,000        $21,360,215                      $0   \n",
      "99       $6,200,000        $20,457,158              $2,303,487   \n",
      "\n",
      "   WorldwideBox Office  \n",
      "0       $2,797,800,564  \n",
      "1       $1,656,943,394  \n",
      "2       $1,073,469,600  \n",
      "3       $1,447,549,711  \n",
      "4       $1,073,394,813  \n",
      "..                 ...  \n",
      "95         $37,565,233  \n",
      "96         $22,679,978  \n",
      "97         $40,786,480  \n",
      "98         $21,360,215  \n",
      "99         $22,760,645  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2019\n",
      "2020 https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/2020/2020/None/None/None/None/None/None?view-order-by=domestic-box-office&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[    Unnamed: 0  Released                                   Title  \\\n",
      "0            1      2020                       Bad Boys For Life   \n",
      "1            2      2020                      Sonic The Hedgehog   \n",
      "2            3      2020  Birds of Prey (And the Fantabulous Em…   \n",
      "3            4      2020                                Dolittle   \n",
      "4            5      2020                       The Invisible Man   \n",
      "..         ...       ...                                     ...   \n",
      "95          96      2020                            Clifton Hill   \n",
      "96          97      2020                         Heart of Africa   \n",
      "97          98      2020                               Premature   \n",
      "98          99      2020                          Le jeune Ahmed   \n",
      "99         100      2020               La cordillÃ¨re des songes   \n",
      "\n",
      "   TheatricalDistributor              Genre  \\\n",
      "0          Sony Pictures             Action   \n",
      "1     Paramount Pictures          Adventure   \n",
      "2           Warner Bros.             Action   \n",
      "3              Universal          Adventure   \n",
      "4              Universal             Horror   \n",
      "..                   ...                ...   \n",
      "95          IFC Midnight  Thriller/Suspense   \n",
      "96   Purdie Distribution              Drama   \n",
      "97             IFC Films              Drama   \n",
      "98           Kino Lorber              Drama   \n",
      "99          Icarus Films        Documentary   \n",
      "\n",
      "                               Source       ProductionMethod  \\\n",
      "0                 Original Screenplay            Live Action   \n",
      "1                       Based on Game  Animation/Live Action   \n",
      "2        Based on Comic/Graphic Novel            Live Action   \n",
      "3   Based on Fiction Book/Short Story  Animation/Live Action   \n",
      "4   Based on Fiction Book/Short Story            Live Action   \n",
      "..                                ...                    ...   \n",
      "95                Original Screenplay            Live Action   \n",
      "96                Original Screenplay            Live Action   \n",
      "97                Original Screenplay            Live Action   \n",
      "98                Original Screenplay            Live Action   \n",
      "99          Based on Real Life Events            Live Action   \n",
      "\n",
      "            CreativeType ProductionBudget DomesticBox Office  \\\n",
      "0   Contemporary Fiction      $90,000,000       $204,417,855   \n",
      "1           Kids Fiction      $90,000,000       $146,066,470   \n",
      "2             Super Hero      $82,000,000        $84,158,461   \n",
      "3                Fantasy     $175,000,000        $77,047,065   \n",
      "4        Science Fiction       $7,000,000        $64,914,050   \n",
      "..                   ...              ...                ...   \n",
      "95  Contemporary Fiction               $0            $25,084   \n",
      "96  Contemporary Fiction               $0            $24,139   \n",
      "97  Contemporary Fiction               $0            $23,071   \n",
      "98  Contemporary Fiction               $0            $21,291   \n",
      "99               Factual               $0            $20,943   \n",
      "\n",
      "   InternationalBox Office WorldwideBox Office  \n",
      "0             $213,232,382        $417,650,237  \n",
      "1             $159,944,877        $306,011,347  \n",
      "2             $117,557,130        $201,715,591  \n",
      "3             $151,143,300        $228,190,365  \n",
      "4              $66,058,387        $130,972,437  \n",
      "..                     ...                 ...  \n",
      "95                      $0             $25,084  \n",
      "96                      $0             $24,139  \n",
      "97                      $0             $23,071  \n",
      "98              $1,438,747          $1,460,038  \n",
      "99                      $0             $20,943  \n",
      "\n",
      "[100 rows x 12 columns],                                 0           1  \\\n",
      "0               Show Release Date   Order By:   \n",
      "1               Show Release Year  Direction:   \n",
      "2          Show Production Budget         NaN   \n",
      "3   Show Opening Weekend Theaters         NaN   \n",
      "4           Show Maximum Theaters         NaN   \n",
      "5     Show Theatrical Engagements         NaN   \n",
      "6    Show Opening Weekend Revenue         NaN   \n",
      "7     Show Worldwide Release Date         NaN   \n",
      "8     Show Theatrical Distributor         NaN   \n",
      "9                     Show Source         NaN   \n",
      "10             Show Creative Type         NaN   \n",
      "\n",
      "                                                    2  \n",
      "0   Release Date  Release Year  Production Budget ...  \n",
      "1                               Ascending  Descending  \n",
      "2                                                 NaN  \n",
      "3                            Show Domestic Box Office  \n",
      "4                     Show Infl. Adj. Dom. Box Office  \n",
      "5                       Show International Box Office  \n",
      "6                           Show Worldwide Box Office  \n",
      "7                         Show Worldwide Release Year  \n",
      "8                                          Show Genre  \n",
      "9                              Show Production Method  \n",
      "10                                                NaN  ]\n",
      "the-numbers-2020\n"
     ]
    }
   ],
   "source": [
    "# Create an iterator in a for-loop\n",
    "for i in range(2010,2021,+1): # the range object begins at year 2010 and increases by 1 year, stopping before 2020\n",
    "    a = 'https://www.the-numbers.com/movies/report/All/All/All/All/All/All/All/All/All/None/None/'\n",
    "    b = '/'\n",
    "    c = '/None/None/None/None/None/None'\n",
    "    d = '?view-order-by=domestic-box-office'\n",
    "    e = '&show-release-year=On&view-order-direction=desc&show-production-budget=On&show-domestic-box-office=On&show-international-box-office=On&show-worldwide-box-office=On'\n",
    "    f = '&show-theatrical-distributor=On&show-genre=On&show-source=On&show-production-method=On&show-creative-type=On'\n",
    "    \n",
    "    url = a + str(i) + b + str(i) + c + d + e + f # stitching the components of the URL with the year determined by the for loop\n",
    "    \n",
    "    print(str(i) + ' ' + url)  # printing the URL to make sure they work!\n",
    "    print()\n",
    "    \n",
    "    header = {\n",
    "  \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36\",\n",
    "  \"X-Requested-With\": \"XMLHttpRequest\"\n",
    "    } # the header allows the script to act like a browser when accessing the URL \n",
    "\n",
    "    r = requests.get(url, headers=header) # utilizing get function in requests in request to navigate to the URL using the specified browsers as the headers parameters\n",
    "\n",
    "    df = pd.read_html(r.text) #  using pandas to read the HTML obtained above\n",
    "    \n",
    "    print(df) # inspecting what was returned\n",
    "    \n",
    "    df = df[0] # using view-source in the browser, we noticed that the second form was actually an additional table\n",
    "    # this line specifies that we only wish to use the first table, which contains our movie data\n",
    "    \n",
    "    df_name = 'the-numbers-' + str(i) # creates a unique name for each dataframe produced that can be used to save it as a csv\n",
    "    \n",
    "    print(df_name) # checking the name!\n",
    "    \n",
    "    #df.to_csv(f\"{df_name}.csv\") # saves the dataframe for a given year as a unique CSV"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Concatenating CSVs"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "While the code above provides us with the data that we need, cleaning, manipulating, and exploring the data would be much easier with a master CSV that contained data from all of the years."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "(1) Each of the CSV files has the same column names, and every entry in each individual data frame contains the same year. The logical way to stitch these dataframes together would be along the index, in a vertical fashion, in chronological order. Due to this, we chose the pandas concat method and specified axis = 0 to indicate that we wish to concatacate the CSVs along the index.   \n",
    "We generalized this process into a function so that we could automate the process to deal with all of our seperate CSV files. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "# generalzing function so i can feed it my list of files\n",
    "def concat_f(x,y):\n",
    "    df = pd.concat([x,y], axis = 0) \n",
    "    return df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "(2) Next, we need to specify the first CSV as our starting point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('the-numbers-2010.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "(3) Finally, we created an iterator object that:\n",
    "- generates the appropriate CSV file names\n",
    "- store the file name in a variable (f)\n",
    "- reads the CSV indicated by (f), and stores the resulting pandas dataframe object in a variable (y)\n",
    "- stores the result of concat_f in the variable(df) so that it can be used as the base df in the next iteration"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# iterate it over a range\n",
    "for i in range(2011,2021): # represents the number of tables scraped from tn\n",
    "    f = 'the-numbers-' + str(i) + '.csv' \n",
    "    print(f) # prints the file name to monitor accuracy\n",
    "    y = pd.read_csv(f) # read and store the csv in a dummy variable\n",
    "    df = concat_f(df,y) # stores the result of concat_f\n",
    "\n",
    "#df.shape # checking to make sure all the entries made it in"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "(4) Finally, we save the concatenated dataframe as our master CSV."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv(f\"the-numbers-master-df.csv\", index = 'ignore') # saves the dataframe for a given year as a unique CSV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('the-numbers-master-df.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3. Exploring the Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.shape # checking the size of the database, by rows and columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.info() # checking for missing values and examining data types"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.head() # examining a few rows"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1) Dropping Unnecessary Extra Index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.drop('Unnamed: 0', axis = 1, inplace = True) # removing unneccessary indices"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "2) Checking for Duplicates"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "x = list(df.Title[df.Title.duplicated()]) # checking for duplicates\n",
    "x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "y = df[df.Title == 'Robin Hood'] # examining duplicates to determine they are actually different movies\n",
    "y"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "3) Cleaning up the currency so we can perform numerical operations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def clean_currency(col):\n",
    "    return col.str.replace('$','').str.replace(',','').astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in [-1,-2,-3,-4]:    # iterating over the four financial columns\n",
    "    df[df.columns[i]] = clean_currency(df[df.columns[i]])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "4) Engineering Features"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['NetProfits'] = df.WorldwideGross - df.Budget # engineering a NP feature"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['ROI'] = round((df.NetProfits / df.Budget),0) # engineering ROI ratio feature"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "5) Dropping some outliers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.drop(df[df['ProductionMethod'] == 'Multiple Production Methods'].index, inplace = True) # there was only 1\n",
    "df.drop(df[df['ProductionMethod'] == 'Stop-Motion Animation'].index, inplace = True) # there was only a handful and they had no ROI"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df[df.Year < 2020] # eliminating movies from 2020 due to world events and lack of data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv(r'master_df.csv', index = False) # please don't run this a second time, the master_df.csv is already in the repo"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:learn-env] *",
   "language": "python",
   "name": "conda-env-learn-env-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
